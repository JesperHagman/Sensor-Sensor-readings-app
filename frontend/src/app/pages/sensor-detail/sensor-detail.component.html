<!-- src/app/features/sensor-detail/sensor-detail.component.html -->
<section class="wrap">
  <a routerLink="/sensors">← Tillbaka</a>

  <h1 *ngIf="sensor">
    {{ sensor.name }} <small>({{ sensor.model }})</small>
  </h1>

  <!-- Filter -->
  <form [formGroup]="form" (ngSubmit)="applyFilter()" class="filters">
    <label>
      Start:
      <input type="datetime-local" formControlName="start" />
    </label>
    <label>
      Slut:
      <input type="datetime-local" formControlName="end" />
    </label>
    <button type="submit">Filtrera</button>
  </form>

  <div *ngIf="loading">Laddar…</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <!-- Graf -->
  <div style="height: 320px; margin-top: 12px;">
    <canvas #lineChart></canvas>
  </div>

  <!-- Paginering -->
  <div class="pager" *ngIf="pageData">
    <button (click)="prevPage()" [disabled]="page===1">Föregående</button>
    <span>
      Sida {{ page }} / {{ totalPages }}
      — totalt {{ pageData.count }} rader
    </span>
    <button (click)="nextPage()" [disabled]="page*pageSize >= pageData.count">Nästa</button>
  </div>

  <!-- Tabell: senaste 20 från sidan -->
  <h2 style="margin-top: 16px;">Senaste 20 på sidan</h2>
  <table *ngIf="latest20.length">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>Temp (°C)</th>
        <th>Humidity (%)</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let r of latest20">
        <td>{{ r.timestamp | date:'yyyy-MM-dd HH:mm:ss' }}</td>
        <td>{{ r.temperature }}</td>
        <td>{{ r.humidity }}</td>
      </tr>
    </tbody>
  </table>
</section>